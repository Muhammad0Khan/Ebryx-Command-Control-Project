{% extends 'dashboard_base.html' %} {% block content %}
<style>
	table {
		border-collapse: collapse;
		width: 100%;
		border-radius: 6px; /* Rounded corners */
		overflow: hidden; /* Ensure rounded corners are visible */
	}

	th,
	td {
		background-color: #252525; /* Light background color for header */
		color: #bdbdbd; /* Dark text color for header */
		
		text-align: left;
		padding: 12px;
	}

	tr {
		border: 1px solid #444444; /* Light border color */
	}
	th {
		background-color: #252525; /* Light background color for header */
		color: #bdbdbd; /* Dark text color for header */
	}

	.status {
		font-weight: bold;
	}
</style>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<div class="mt-4">
	<div class="">
		<h1>Network Information</h1>
		<nav>
			<ol class="breadcrumb">
				<li class="breadcrumb-item">
					<a href="{% url 'dashboard' %}">Dashboard</a>
				</li>
				<li class="breadcrumb-item"><a href="#">Network Information</a></li>
			</ol>
		</nav>
	</div>

	<div class="row">
		<div class="col-lg-6">
			<div class="card">
				<div class="card-body">
					
					<h3 class="mt-4">WIFI (en0)</h3>
					<div id="reportsChart1"></div>
				</div>
			</div>
		</div>

		<div class="col-lg-6">
			<div class="card">
				<div class="card-body">
					
					<h3 class="mt-4">System Interface (lo0)</h3>
					<div id="reportsChart2"></div>
				</div>
			</div>
		</div>
	</div>
	<div class="row">
		<div class="col-lg">
			<div class="card">
				<div class="card-body">
					<table class=" mt-4">
						<thead>
							<tr>
								<th>Interface</th>
								<th>Download</th>
								<th>Total Upload</th>
								<th>Upload Speed</th>
								<th>Download Speed</th>
							</tr>
						</thead>
						<tbody>
							{% for entry in last_data_section %}
							<tr>
								<td>{{ entry.iface }}</td>
								<td>{{ entry.data.download }}</td>
								<td>{{ entry.data.total_upload }}</td>
								<td>{{ entry.data.upload_speed }}</td>
								<td>{{ entry.data.download_speed }}</td>
							</tr>
							{% endfor %}
						</tbody>
					</table>
					<!-- End Area Chart -->
				</div>
			</div>
		</div>
	</div>


	<script> 
		document.addEventListener("DOMContentLoaded", () => {
			new ApexCharts(document.querySelector("#reportsChart1"), {
					series: [
							{
									name: "Download Data",
									data: {{ download_data | safe }},
							},
							{
									name: "Upload Data",
									data: {{ upload_data | safe }},
							},
					],
					chart: {
							height: 200,
							type: "area",
							toolbar: {
									show: false,
							},
					},
					markers: {
							size: 4,
					},
					colors: ["#f87979", "#2eca6a"],
					fill: {
							type: "gradient",
							gradient: {
								shadeIntensity: 0.3,
								opacityFrom: 0.2,
								opacityTo: 0.5,
									stops: [0, 90, 100],
							},
					},
					dataLabels: {
							enabled: false,
					},
					stroke: {
							curve: "smooth",
							width: 2,
					},
					xaxis: {
							type: "datetime",
							categories: {{ timestamp | safe }},
					},
					tooltip: {
							x: {
									format: "dd/MM/yy HH:mm",
							},
					},
			}).render();
	});
	
</script>
	<script> 
			document.addEventListener("DOMContentLoaded", () => {
				new ApexCharts(document.querySelector("#reportsChart2"), {
						series: [
								{
										name: "Download Data",
										data: {{ download_data2 | safe }},
								},
								{
										name: "Upload Data",
										data: {{ upload_data2 | safe }},
								},
						],
						chart: {
								height: 200,
								type: "area",
								toolbar: {
										show: false,
								},
						},
						markers: {
								size: 4,
						},
						colors: ["#f87979", "#2eca6a"],
						fill: {
								type: "gradient",
								gradient: {
									shadeIntensity: 0.3,
									opacityFrom: 0.2,
									opacityTo: 0.5,
									stops: [0, 90, 100],
							},
						},
						dataLabels: {
								enabled: false,
						},
						stroke: {
								curve: "smooth",
								width: 2,
						},
						xaxis: {
								type: "datetime",
								categories: {{ timestamp | safe }},
						},
						tooltip: {
								x: {
										format: "dd/MM/yy HH:mm",
								},
						},
				}).render();
		});
		
	</script>

	<script>
		// Reload data every 5 seconds
		setInterval(function () {
			fetch("/hardware_info/") // Replace with the actual URL of your dashboard view
				.then(response => response.text())
				.then(html => {
					const parser = new DOMParser();
					const newDoc = parser.parseFromString(html, "text/html");
					const newTableBody = newDoc.getElementById("tokenTableBody");
					document.getElementById("tokenTableBody").innerHTML =
						newTableBody.innerHTML;
				})
				.catch(error => console.error("Error fetching data:", error));
		}, 5000);
	</script>
	
	{% endblock %}
</div>
