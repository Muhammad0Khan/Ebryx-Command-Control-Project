{% extends 'dashboard_base.html' %} 
{% block content %}
{% load static %}

<div class="mt-4">
    <div class="">
        <h1>Terminal</h1>
        <nav>
            <ol class="breadcrumb">
                <li class="breadcrumb-item">
                    <a href="{% url 'dashboard' %}">Dashboard</a>
                </li>
                <li class="breadcrumb-item">
                    <a href="#">Terminal</a>
                </li>
            </ol>
        </nav>
    </div>
    <div class="card">
        <div class="card-body">
            <div class="row mb-3">
                <label class="col-sm-2 col-form-label">Select Host</label>
                <form id="TerminalForm" method="GET">
                    <select id="tokenSelect" name="token" class="form-select" aria-label="Select Hostname">
                        {% for token_info in tokens %}
                        <option value="{{ token_info.token }}">
                            {{ token_info.system_data.hostname }}
                        </option>
                        {% endfor %}
                    </select>
                    
                    <button type="submit" class="btn btn-primary mt-3">Generate Terminal</button>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
    document.getElementById("TerminalForm").addEventListener("submit", function(event) {
        event.preventDefault(); // Prevent default form submission
        var selectedToken = document.getElementById("tokenSelect").value;
        var formAction = "/api/generate_terminal/" + selectedToken + "/";
        window.location.href = formAction; // Redirect to the constructed URL
    });
</script>

{% endblock %}
