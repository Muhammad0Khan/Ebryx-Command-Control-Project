{% extends 'base.html' %} {% block content %}

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<h1>CPU Information</h1>

{% if error_message %}
<p>{{ error_message }}</p>
{% else %}
<p>Timestamp: {{ timestamp }}</p>
<p>System Name: {{ system_name }}</p>
<p>Hostname: {{ hostname }}</p>

<canvas id="cpuUsageChart" width="400" height="200"></canvas>
<canvas id="perCpuUsageChart" width="400" height="200"></canvas>

<canvas id="perCpuChart" width="400" height="200"></canvas>

<script>
	// Extract per_cpu_percent array from the context
	var perCpuPercent = {{ per_cpu_percent|safe }};

	// Get the canvas element
	var ctx = document.getElementById('perCpuChart').getContext('2d');

	// Create a line chart
	var myChart = new Chart(ctx, {
	  type: 'bar',
	  data: {
	    labels: perCpuPercent.map((_, index) => `CPU ${index + 1}`),
	    datasets: [{
	      label: 'Per CPU Usage (%)',
	      data: perCpuPercent,
	      borderColor: 'rgba(75, 192, 192, 1)',
	      borderWidth: 1,
	      fill: false,
	    }]
	  },
	  options: {
	    scales: {
	      y: {
	        beginAtZero: true,
	        max: 100,
	      }
	    }
	  }
	});
</script>
{% endif %} {% endblock %}
